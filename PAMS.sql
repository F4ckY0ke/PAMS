/*
Navicat MySQL Data Transfer

Source Server         : PAMS
Source Server Version : 80020
Source Host           : 124.71.190.194:3306
Source Database       : PAMS

Target Server Type    : MYSQL
Target Server Version : 80020
File Encoding         : 65001

Date: 2021-03-29 11:29:09
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for A_CANSHU
-- ----------------------------
DROP TABLE IF EXISTS `A_CANSHU`;
CREATE TABLE `A_CANSHU` (
  `CANSHUNAME` varchar(24) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  `CANSHUVALUE` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `BEIZHU` varchar(128) COLLATE utf8mb4_general_ci DEFAULT NULL,
  PRIMARY KEY (`CANSHUNAME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- ----------------------------
-- Records of A_CANSHU
-- ----------------------------
INSERT INTO `A_CANSHU` VALUES ('ACCESS_TOKEN', '24.b645c351048003e4e05b01b516d47e38.2592000.1618734055.282335-23730216', '二维码识别API的ACCESS_TOKEN半个月失效，会自动根据API_KEY和SECRET_KEY自动更新');
INSERT INTO `A_CANSHU` VALUES ('API_KEY', 'zjgnBoRSR6xn7PA07kDGfcat', '百度人脸识别应用的API_KEY');
INSERT INTO `A_CANSHU` VALUES ('APP_ID', '23131037', '百度人脸识别应用的API_ID');
INSERT INTO `A_CANSHU` VALUES ('FACE_SCORE', '90', '人脸识别分数阈值，高于此分数则验证通过');
INSERT INTO `A_CANSHU` VALUES ('GROUPID', 'user1', '百度人脸库用户组名');
INSERT INTO `A_CANSHU` VALUES ('GUANLIMOSHI', '1', '1 默认 二维码 + 人脸\r\n2 仅小区  人脸\r\n3 仅来访 二维码\r\n4 全开 \r\n\r\n1 .默认 二维码 + 人脸2.仅小区  人脸3.仅来访 二维码4. 全开 5.全闭');
INSERT INTO `A_CANSHU` VALUES ('LIVENESS_CONTROL', 'NORMAL', '活体检测控制 NONE: 不进行控制 LOW:较低的活体要求(高通过率 低攻击拒绝率) NORMAL: 一般的活体要求(平衡的攻击拒绝率, 通过率) HIGH: 较高的活体要求(高攻击拒绝率 低通过率) 默认NONE');
INSERT INTO `A_CANSHU` VALUES ('QRAPI_KEY', 'KnlmM8wRl87ZsI4MWu8lCQg0', '百度二维码识别应用的API_KEY');
INSERT INTO `A_CANSHU` VALUES ('QRSECRET_KEY', '3nMrgQDwEkmlH0ili0me5yg6Ild1idLk', '百度二维码识别应用的SECRET_KEY');
INSERT INTO `A_CANSHU` VALUES ('QUALITY_CONTROL', 'NORMAL', '图片质量控制 NONE: 不进行控制 LOW:较低的质量要求 NORMAL: 一般的质量要求 HIGH: 较高的质量要求 默认 NONE');
INSERT INTO `A_CANSHU` VALUES ('SECRET_KEY', '4TowiYl4zRGTW4GZcil5Cmvp6Ev089NE', '百度人脸识别应用的SECRET_KEY');
INSERT INTO `A_CANSHU` VALUES ('TIME_OUT', '3', '识别到人脸后延迟拍照的时间，单位：秒');

-- ----------------------------
-- Table structure for L_VISIT
-- ----------------------------
DROP TABLE IF EXISTS `L_VISIT`;
CREATE TABLE `L_VISIT` (
  `ID` int NOT NULL AUTO_INCREMENT,
  `V_LORV` varchar(8) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `V_SHEBEI` varchar(8) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `V_IDCARD` varchar(24) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `V_TEL` varchar(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `V_TIME` datetime DEFAULT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=88 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- ----------------------------
-- Records of L_VISIT
-- ----------------------------
INSERT INTO `L_VISIT` VALUES ('4', 'LOCAL', 'AS', '452226199912345678', '13112341234', '2021-03-19 14:49:48');
INSERT INTO `L_VISIT` VALUES ('5', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-19 14:52:09');
INSERT INTO `L_VISIT` VALUES ('14', 'VISITOR', 'X1M', '450221199999999999', '13111111111', '2021-03-19 15:17:07');
INSERT INTO `L_VISIT` VALUES ('53', 'VISITOR', '西1门', '450221199999999999', '13111111111', '2021-03-19 16:48:14');
INSERT INTO `L_VISIT` VALUES ('54', 'VISITOR', '西1门', '450221199999999999', '13111111111', '2021-03-19 16:50:15');
INSERT INTO `L_VISIT` VALUES ('55', 'VISITOR', '西1门', '450221199999999999', '13111111111', '2021-03-19 16:51:29');
INSERT INTO `L_VISIT` VALUES ('56', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-19 16:54:25');
INSERT INTO `L_VISIT` VALUES ('57', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-19 16:55:22');
INSERT INTO `L_VISIT` VALUES ('58', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-19 16:55:48');
INSERT INTO `L_VISIT` VALUES ('59', 'VISITOR', '西1门', '450221199707212427', '13123456789', '2021-03-22 19:42:20');
INSERT INTO `L_VISIT` VALUES ('60', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 09:44:36');
INSERT INTO `L_VISIT` VALUES ('61', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 10:13:45');
INSERT INTO `L_VISIT` VALUES ('62', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 19:23:21');
INSERT INTO `L_VISIT` VALUES ('63', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 19:26:54');
INSERT INTO `L_VISIT` VALUES ('64', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 19:40:34');
INSERT INTO `L_VISIT` VALUES ('65', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 19:53:10');
INSERT INTO `L_VISIT` VALUES ('66', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-23 19:53:17');
INSERT INTO `L_VISIT` VALUES ('67', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-24 22:19:55');
INSERT INTO `L_VISIT` VALUES ('68', 'VISITOR', '西1门', '452226199810010018', '13123456789', '2021-03-24 22:20:46');
INSERT INTO `L_VISIT` VALUES ('69', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-24 22:20:58');
INSERT INTO `L_VISIT` VALUES ('70', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-25 18:27:35');
INSERT INTO `L_VISIT` VALUES ('71', 'VISITOR', '西1门', '130423200009291919', '17752927162', '2021-03-25 18:29:05');
INSERT INTO `L_VISIT` VALUES ('72', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-28 21:37:51');
INSERT INTO `L_VISIT` VALUES ('73', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:42:09');
INSERT INTO `L_VISIT` VALUES ('74', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:42:38');
INSERT INTO `L_VISIT` VALUES ('75', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:44:40');
INSERT INTO `L_VISIT` VALUES ('76', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:45:13');
INSERT INTO `L_VISIT` VALUES ('77', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:45:24');
INSERT INTO `L_VISIT` VALUES ('78', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:46:29');
INSERT INTO `L_VISIT` VALUES ('79', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:49:04');
INSERT INTO `L_VISIT` VALUES ('80', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:51:10');
INSERT INTO `L_VISIT` VALUES ('81', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:52:32');
INSERT INTO `L_VISIT` VALUES ('82', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:57:42');
INSERT INTO `L_VISIT` VALUES ('83', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:58:20');
INSERT INTO `L_VISIT` VALUES ('84', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 10:59:17');
INSERT INTO `L_VISIT` VALUES ('85', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 11:00:38');
INSERT INTO `L_VISIT` VALUES ('86', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 11:04:17');
INSERT INTO `L_VISIT` VALUES ('87', 'LOCAL', '西1门', '452226199912345678', '13112341234', '2021-03-29 11:06:04');

-- ----------------------------
-- Table structure for U_ADMIN
-- ----------------------------
DROP TABLE IF EXISTS `U_ADMIN`;
CREATE TABLE `U_ADMIN` (
  `USER` varchar(16) COLLATE utf8mb4_general_ci NOT NULL,
  `PASSWORD` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  `MODE` int DEFAULT NULL,
  `TEL` varchar(16) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `NAME` varchar(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `IDCARD` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  PRIMARY KEY (`USER`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- ----------------------------
-- Records of U_ADMIN
-- ----------------------------
INSERT INTO `U_ADMIN` VALUES ('admin', '$2y$10$icQbs0XeqbMC6lfj4me9Wuh.XuP2KRYqBXmL1wBnGGV7Eo0WsAGVe', '7', '13123456789', 'test', '45222619812345678');
INSERT INTO `U_ADMIN` VALUES ('renlian', '$2y$10$KQIfk9WK2icUw3m54kmbtetjCdboqQhfLz/gg3pJxYmq6zQSVw8vO', '1', '13123456789', 'DWFD', 'WEFW');
INSERT INTO `U_ADMIN` VALUES ('root', '$2y$10$2XN2HZL7X3E7GuWtJ4aoOOGJWhCYrm0HBjwGkjwO3UNRZUdk6siSG', '6', '', 'tetete', '');
INSERT INTO `U_ADMIN` VALUES ('shuju', '$2y$10$Q/fink1JFSfGOd2TOALQLOsF1ZQWha3L2nqyzl1Oq2gquNxpSGEjW', '2', '13123456789', '', '');
INSERT INTO `U_ADMIN` VALUES ('test', '$2y$10$xCjN1ANHlAyD4xcQcQUCTeLXmofGF4D71EqIjbyBS4njexSwn3g.6', '2', '13123456789', 'test1', '');
INSERT INTO `U_ADMIN` VALUES ('testtest', '$2y$10$T0lwn98CeiIMP3/dMSSyvuPlCz3udE5kRB./1B.3HVU8zwfbMzxkS', '1', '13123456789', 'test1', '45222619812345678');
INSERT INTO `U_ADMIN` VALUES ('xitong', '$2y$10$9B6dFCnP0P7VUxq/RNawj.xoisf6tt4BAb6UpPaVpWsEI7Bo1rb/S', '4', '13123456789', '', '');

-- ----------------------------
-- Table structure for U_LOCAL
-- ----------------------------
DROP TABLE IF EXISTS `U_LOCAL`;
CREATE TABLE `U_LOCAL` (
  `ID` int NOT NULL AUTO_INCREMENT,
  `USERFLAG` int DEFAULT NULL,
  `FACENAME` varchar(16) NOT NULL,
  `NAME` varchar(16) DEFAULT NULL,
  `IDCARD` varchar(24) DEFAULT NULL,
  `TEL` varchar(16) DEFAULT NULL,
  `ADDRESS` varchar(24) DEFAULT NULL,
  `REGTIME` datetime DEFAULT NULL,
  PRIMARY KEY (`ID`,`FACENAME`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of U_LOCAL
-- ----------------------------
INSERT INTO `U_LOCAL` VALUES ('1', '1', 'ls', '谢家源', '452226199912345678', '13112341234', '26栋5-4', '2021-03-12 00:00:00');
INSERT INTO `U_LOCAL` VALUES ('2', '0', 'AAbc1', 'TEST', '45222619999999999', '13123456789', '26-55-5', '2021-03-26 09:53:39');
INSERT INTO `U_LOCAL` VALUES ('3', '1', 'DFd', 'FWEFW', '234234234', '141341412', 'DDWDFWER', '2021-03-25 16:10:11');
INSERT INTO `U_LOCAL` VALUES ('5', '0', '23t2r', '23423r21', '23tf2', '23r2r', '23r2', '2021-03-26 09:53:50');
INSERT INTO `U_LOCAL` VALUES ('6', '1', 'ergerg', 'ewrt34', '23423', 'WEFWE', 'gweg', '2021-03-26 09:55:14');

-- ----------------------------
-- Table structure for U_VISITOR
-- ----------------------------
DROP TABLE IF EXISTS `U_VISITOR`;
CREATE TABLE `U_VISITOR` (
  `ID` int NOT NULL AUTO_INCREMENT,
  `CODEFLAG` int DEFAULT NULL,
  `RANDOM` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  `IDCARD` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `TEL` varchar(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL,
  `REGTIME` datetime DEFAULT NULL,
  PRIMARY KEY (`ID`,`RANDOM`)
) ENGINE=InnoDB AUTO_INCREMENT=66 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- ----------------------------
-- Records of U_VISITOR
-- ----------------------------
INSERT INTO `U_VISITOR` VALUES ('44', '0', 'e8aa7b134d52d18e882183a3ab4d1', '4522261998100100011', '131234567891', '2021-03-26 09:52:04');
INSERT INTO `U_VISITOR` VALUES ('45', '0', '735247dd1d9999a39aff43a020f7', '452226199810010018', '13123456789', '2021-03-22 18:52:44');
INSERT INTO `U_VISITOR` VALUES ('46', '0', '58321b2cbdb97c1a717eb6abafc5', '452226199810010018', '13123456789', '2021-03-22 18:56:18');
INSERT INTO `U_VISITOR` VALUES ('47', '0', 'abb4dec580a737e2551e011749c1', '452226199810010018', '13123456789', '2021-03-22 18:57:51');
INSERT INTO `U_VISITOR` VALUES ('49', '0', 'f68e4ce9870cdae3c119b451f617', '452226199810010018', '13123456789', '2021-03-22 18:59:02');
INSERT INTO `U_VISITOR` VALUES ('50', '0', 'cd5543e0159f4fd9774fc7e45795', '452226199810010018', '13123456789', '2021-03-22 19:13:39');
INSERT INTO `U_VISITOR` VALUES ('51', '0', '83f0f9c3cdffa8d4b1a89a846bce', '452226199810010018', '13123456789', '2021-03-22 19:15:19');
INSERT INTO `U_VISITOR` VALUES ('52', '0', 'ef00a1b6a65e3a26e734b597fb91', '452226199810010018', '13123456789', '2021-03-22 19:24:59');
INSERT INTO `U_VISITOR` VALUES ('53', '0', '0734900e81e70e46ed9655c2d692', '452226199810010018', '13123456789', '2021-03-22 19:25:52');
INSERT INTO `U_VISITOR` VALUES ('54', '0', 'b8f3960320f9dcd5b63f9babcd0f', '452226199810010018', '13123456789', '2021-03-22 19:26:54');
INSERT INTO `U_VISITOR` VALUES ('55', '0', 'e2884a6c1f17ea3e74f23d620c40', '452226199810010018', '13123456789', '2021-03-22 19:28:26');
INSERT INTO `U_VISITOR` VALUES ('56', '0', '33e440d1fe6172c2e50daf33769b', '452226199810010018', '13123456789', '2021-03-22 19:28:34');
INSERT INTO `U_VISITOR` VALUES ('57', '0', '33ee2faf9be2ca8c21a9c83b539c', '452226199810010018', '13123456789', '2021-03-22 19:29:25');
INSERT INTO `U_VISITOR` VALUES ('58', '0', '17633ffe905a34770c80d8841875', '452226199810010018', '13123456789', '2021-03-22 19:31:03');
INSERT INTO `U_VISITOR` VALUES ('59', '0', 'a50ece51c5e33cd4ce1e05e81a50', '450221199707212427', '13123456789', '2021-03-22 19:42:10');
INSERT INTO `U_VISITOR` VALUES ('60', '0', '2abb506ac80e5e79a51e2d367c31', '452226199810010018', '13123456789', '2021-03-23 09:49:15');
INSERT INTO `U_VISITOR` VALUES ('61', '0', '49fdfd0eff9ee32931009a5b91d8', '452226199810010018', '13123456789', '2021-03-23 09:49:33');
INSERT INTO `U_VISITOR` VALUES ('62', '0', '04c438d76a15aa162e579fc9fbd4', '452226199810010018', '13123456789', '2021-03-23 10:59:12');
INSERT INTO `U_VISITOR` VALUES ('63', '0', '64ea97b189c6dfe4d085c49a1fb4', '452226199810010018', '13123456789', '2021-03-24 22:20:36');
INSERT INTO `U_VISITOR` VALUES ('64', '0', 'a0000901361380db02ecfdc90e75', '130423200009291919', '13345678912', '2021-03-25 18:16:54');

-- ----------------------------
-- Procedure structure for CHECKFACE
-- ----------------------------
DROP PROCEDURE IF EXISTS `CHECKFACE`;
DELIMITER ;;
CREATE DEFINER=`pamadmin`@`%` PROCEDURE `CHECKFACE`(
	IN CSHEBEI VARCHAR(8),
	IN CFACENAME VARCHAR(32))
BEGIN

DECLARE J_MOSHI INT UNSIGNED;
DECLARE J_CHECK INT UNSIGNED DEFAULT 0;
DECLARE J_IDCARD VARCHAR(24) DEFAULT 'UNKNOW';
DECLARE J_TEL VARCHAR(16) DEFAULT 'UNKNOW';
DECLARE J_TIME DATETIME;
SELECT CANSHUVALUE FROM A_CANSHU WHERE CANSHUNAME = 'GUANLIMOSHI' INTO J_MOSHI;
CASE J_MOSHI
WHEN '1' OR '2' THEN
SELECT USERFLAG,IDCARD,TEL FROM U_LOCAL WHERE FACENAME = CFACENAME INTO J_CHECK,J_IDCARD,J_TEL;
IF J_CHECK=1 THEN
SELECT now() INTO J_TIME;
INSERT INTO L_VISIT (V_LORV,V_SHEBEI,V_IDCARD,V_TEL,V_TIME) VALUES('LOCAL',CSHEBEI,J_IDCARD,J_TEL,J_TIME);
SELECT 1 AS R_JIEGUO;
ELSE
SELECT 0 AS R_JIEGUO;
END IF;
WHEN '3' OR '5' THEN
SELECT 0 AS R_JIEGUO;
WHEN '4' THEN
SELECT 1 AS R_JIEGUO;
ELSE
SELECT 0 AS R_JIEGUO;
END CASE;
END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for CHECKRANDOM
-- ----------------------------
DROP PROCEDURE IF EXISTS `CHECKRANDOM`;
DELIMITER ;;
CREATE DEFINER=`pamadmin`@`%` PROCEDURE `CHECKRANDOM`(
	IN CSHEBEI VARCHAR(8),
	IN CRANDOM VARCHAR(32))
BEGIN

DECLARE J_MOSHI INT UNSIGNED;
DECLARE J_CHECK INT UNSIGNED DEFAULT 0;
DECLARE J_IDCARD VARCHAR(24) DEFAULT 'UNKNOW';
DECLARE J_TEL VARCHAR(16) DEFAULT 'UNKNOW';
DECLARE J_TIME DATETIME;
SELECT CANSHUVALUE FROM A_CANSHU WHERE CANSHUNAME = 'GUANLIMOSHI' INTO J_MOSHI;
CASE J_MOSHI
WHEN '1' OR '3' THEN
SELECT CODEFLAG,IDCARD,TEL FROM U_VISITOR WHERE RANDOM = CRANDOM INTO J_CHECK,J_IDCARD,J_TEL;
IF J_CHECK=1 THEN
SELECT now() INTO J_TIME;
INSERT INTO L_VISIT (V_LORV,V_SHEBEI,V_IDCARD,V_TEL,V_TIME) VALUES('VISITOR',CSHEBEI,J_IDCARD,J_TEL,J_TIME);
SELECT 1 AS R_JIEGUO;
ELSE
SELECT 0 AS R_JIEGUO;
END IF;
WHEN '2' OR '5' THEN
SELECT 0 AS R_JIEGUO;
WHEN '4' THEN
SELECT 1 AS R_JIEGUO;
ELSE
SELECT 0 AS R_JIEGUO;
END CASE;
END
;;
DELIMITER ;

-- ----------------------------
-- Procedure structure for INSERTRANDOM
-- ----------------------------
DROP PROCEDURE IF EXISTS `INSERTRANDOM`;
DELIMITER ;;
CREATE DEFINER=`pamadmin`@`%` PROCEDURE `INSERTRANDOM`(IN CIDCARD VARCHAR(32), IN CTEL VARCHAR(16))
BEGIN
DECLARE J_RANDOM VARCHAR(28) DEFAULT NULL;
DECLARE J_TIME DATETIME;
SELECT substring(md5(rand()), 1, 28) INTO J_RANDOM;
SELECT now() INTO J_TIME;
INSERT INTO U_VISITOR(CODEFLAG, RANDOM, IDCARD, TEL, REGTIME) VALUES (1, J_RANDOM, CIDCARD,CTEL, J_TIME);
SELECT J_RANDOM;
END
;;
DELIMITER ;

-- ----------------------------
-- Event structure for CHECKCODEFLAG
-- ----------------------------
DROP EVENT IF EXISTS `CHECKCODEFLAG`;
DELIMITER ;;
CREATE DEFINER=`pamadmin`@`%` EVENT `CHECKCODEFLAG` ON SCHEDULE EVERY 1 MINUTE STARTS '2021-03-23 11:18:58' ON COMPLETION PRESERVE ENABLE DO UPDATE U_VISITOR SET CODEFLAG = 0 WHERE REGTIME + INTERVAL 1 HOUR < NOW()
;;
DELIMITER ;
